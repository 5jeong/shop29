<div th:insert="fragments/header :: header"></div>
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Product Board</title>

    <!-- Bootstrap CSS 추가 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- 사용자 정의 스타일 추가 -->
    <style>
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffffff !important;
        }

        .navbar {
            background-color: #343a40;
        }

        .nav-link {
            color: #ffffff !important;
        }

        .nav-link.active {
            font-weight: bold;
        }

        .nav-link:hover {
            color: #d4d4d4 !important;
        }

        .btn-outline-success {
            color: #ffffff;
            border-color: #ffffff;
        }

        .btn-outline-success:hover {
            background-color: #ffffff;
            color: #343a40;
        }

        /* 레이아웃 스타일 */
        .container {
            display: flex;
        }

        /* related-middle-categories 왼쪽 정렬 */
        #related-middle-categories {
            width: 200px; /* 사이드바 너비 설정 */
            padding: 10px;
            border-right: 1px solid #ccc;
        }

        /* small-category와 sort-filter를 가로 정렬 */
        #category-and-sort {
            flex-grow: 1;
            padding: 10px;
        }

        #category-and-sort-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        /* Small Category 항목들을 가로로 나열 */
        #small-category-filters ul {
            display: flex;
            list-style: none;
            padding: 0;
        }

        #small-category-filters ul li {
            margin-right: 15px;
        }

        /* Sort by 항목들을 가로로 나열 */
        #sort-option-filters ul {
            display: flex;
            list-style: none;
            padding: 0;
        }

        #sort-option-filters ul li {
            margin-right: 15px;
        }

        #small-category-filters a, #sort-option-filters a {
            text-decoration: none;
            color: #000;
        }

        /* 테이블을 중앙에 위치시키고 간격 추가 */
        #product-list {
            margin: 20px auto;
            width: 100%;
        }

        #product-list table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 15px;
        }

        #product-list th, #product-list td {
            text-align: center;
            padding: 10px;
        }

        /* 테이블 헤더 스타일 */
        #product-list thead {
            background-color: #f8f9fa;
            font-weight: bold;
        }

        /* 페이지 핸들러 스타일 */
        #page-handler {
            margin: 20px auto;
            width: 80%;
            text-align: center;
            font-size: 1.5rem;
        }

        #page-handler a {
            margin: 0 10px;
            text-decoration: none;
            color: #007bff;
        }

        #page-handler a:hover {
            color: #0056b3;
        }
    </style>
</head>

<body>

<div class="container">
    <!-- related-middle-categories 왼쪽 정렬 -->
    <div id="related-middle-categories">
        <h2>Related Middle Categories</h2>
        <ul>
            <li th:each="middleCategory : ${relatedMiddleCategories}">
                <a th:href="@{/product/list(middleCategoryId=${middleCategory.middleCategoryId})}"
                   th:text="${middleCategory.middleCategoryName}"></a>
            </li>
        </ul>
    </div>

    <!-- small-category와 sort-filter를 가로 정렬 -->
    <div id="category-and-sort">
        <div id="category-and-sort-container">
            <!-- 소분류 필터 -->
            <div id="small-category-filters">
                <h2>Small Categories</h2>
                <ul>
                    <li th:each="smallCategory : ${smallCategories}">
                        <a th:href="@{/product/list(smallCategoryId=${smallCategory.smallCategoryId}, middleCategoryId=${middleCategoryId})}"
                           th:text="${smallCategory.smallCategoryName}"></a>
                    </li>
                </ul>
            </div>

            <!-- 정렬 옵션 버튼 -->
            <div id="sort-option-filters">
                <h2>Sort by</h2>
                <ul>
                    <li><a th:href="@{/product/list(sortOption='priceDesc', middleCategoryId=${middleCategoryId}, smallCategoryId=${smallCategoryId})}">높은 가격순</a></li>
                    <li><a th:href="@{/product/list(sortOption='priceAsc', middleCategoryId=${middleCategoryId}, smallCategoryId=${smallCategoryId})}">낮은 가격순</a></li>
                    <li><a th:href="@{/product/list(sortOption='rating', middleCategoryId=${middleCategoryId}, smallCategoryId=${smallCategoryId})}">평점 높은순</a></li>
                    <li><a th:href="@{/product/list(sortOption='newest', middleCategoryId=${middleCategoryId}, smallCategoryId=${smallCategoryId})}">신상품순</a></li>
                    <li><a th:href="@{/product/list(sortOption='highDiscount', middleCategoryId=${middleCategoryId}, smallCategoryId=${smallCategoryId})}">높은 할인순</a></li>
                </ul>
            </div>
        </div>

        <!-- 게시물 -->
        <div id="product-list">
            <table border="1" class="table">
                <thead>
                <tr>
                    <th>번호</th>
                    <th>상품이름</th>
                    <th>브랜드</th>
                    <th>할인율</th>
                    <th>정가</th>
                    <th>할인가</th>
                    <th>별점</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="productDto, status : ${list}">
                    <td th:text="${status.index + 1}"></td>
                    <td><a th:href="@{/product/{productId}(productId=${productDto.productId})}"
                           th:text="${productDto.productName}"></a></td>
                    <td th:text="${productDto.brandId}"></td>
                    <td th:text="${productDto.saleRatio}"></td>
                    <td th:text="${productDto.price}"></td>
                    <td th:text="${productDto.price - (productDto.price * productDto.saleRatio / 100)}"></td>
                    <td th:text="${productDto.rating}"></td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- 페이지 핸들러 -->
<div id="page-handler">
    <!-- 이전 페이지 링크 -->
    <a th:if="${pageHandler != null and pageHandler.showPrev}"
       th:href="@{/product/list(page=${pageHandler.beginPage - 1}, pageSize=${pageHandler.pageSize}, sortOption=${sortOption}, middleCategoryId=${middleCategoryId}, smallCategoryId=${smallCategoryId})}">&lt;</a>

    <!-- 페이지 번호 링크 -->
    <a th:if="${pageHandler != null}"
       th:each="i : ${#numbers.sequence(pageHandler.beginPage, pageHandler.endPage)}"
       th:href="@{/product/list(page=${i}, pageSize=${pageHandler.pageSize}, sortOption=${sortOption}, middleCategoryId=${middleCategoryId}, smallCategoryId=${smallCategoryId})}"
       th:text="${i}"></a>

    <!-- 다음 페이지 링크 -->
    <a th:if="${pageHandler != null and pageHandler.showNext}"
       th:href="@{/product/list(page=${pageHandler.endPage + 1}, pageSize=${pageHandler.pageSize}, sortOption=${sortOption}, middleCategoryId=${middleCategoryId}, smallCategoryId=${smallCategoryId})}">&gt;</a>
</div>
</body>

</html>

